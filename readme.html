<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Documentation</title>
    <!-- Style GitHub DARK pour Markdown -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.5.1/github-markdown-dark.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        body {
            background-color: #0d1117;
            margin: 0;
            padding: 0;
        }
        .markdown-body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 980px;
            margin: 0 auto;
            padding: 45px;
            background-color: #0d1117;
            color: #c9d1d9;
        }
        @media (max-width: 767px) {
            .markdown-body {
                padding: 15px;
            }
        }
        /* Scroll smooth pour les ancres */
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body>
<div class="markdown-body" id="content">Chargement...</div>

<script>
    // Fonction pour générer un ID slug
    function slugify(text) {
        return text.toLowerCase()
            .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // Enlève les accents
            .replace(/[^a-z0-9\s-]/g, '')  // Supprime les caractères spéciaux
            .trim()
            .replace(/\s+/g, '-');  // Remplace les espaces par des tirets
    }

    fetch('README.md')
        .then(response => {
            if (!response.ok) {
                throw new Error('Fichier README.md introuvable');
            }
            return response.text();
        })
        .then(text => {
            // Configuration de marked
            const renderer = {
                heading(token) {
                    const text = token.text;
                    const level = token.depth;
                    const id = slugify(text);

                    return `<h${level} id="${id}">${text}</h${level}>`;
                },
                link(token) {
                    const href = token.href;
                    const text = token.text;
                    const title = token.title;

                    // Si c'est un lien interne (ancre), on le slugifie
                    if (href && href.startsWith('#')) {
                        const decodedHref = decodeURIComponent(href.substring(1));
                        const newHref = '#' + slugify(decodedHref);
                        const titleAttr = title ? ` title="${title}"` : '';
                        return `<a href="${newHref}"${titleAttr}>${text}</a>`;
                    }

                    // Sinon, comportement par défaut
                    const titleAttr = title ? ` title="${title}"` : '';
                    return `<a href="${href}"${titleAttr}>${text}</a>`;
                }
            };

            marked.use({ renderer });

            document.getElementById('content').innerHTML = marked.parse(text);
        })
        .catch(error => {
            console.error('Erreur:', error);
            document.getElementById('content').innerHTML = '<p style="color: #f85149;">Erreur de chargement : ' + error.message + '</p>';
        });
</script>
</body>
</html>